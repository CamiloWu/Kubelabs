# 14. Storage <!-- omit in TOC -->

> [Ver los archivos demo](./kubelabs-files-demo)

> [Documentación Oficial](https://kubernetes.io/docs/concepts/storage/volumes/)

> La configuración de este laboratorio no debe ser aplicada en ambientes productivos.

## 1. Crear un nuevo Pod utilizando el archivo pod-storage.yml
> [kubelabs-files-demo/pod-storage.yml](./kubelabs-files-demo/pod-storage.yml)
```vim
kubectl apply -f kubelabs-files-demo/pod-storage.yml
```
> El archivo incluye un ***service*** en el puerto 30081

## 2. Validar el volumen montado en el pod

```vim
kubectl describe pods pod-storage
```
En la sección ***Containers*** ver la información del punto de montaje:
~~~~
Containers:
...
Mounts:
	/usr/share/nginx/html/ from static-vol (rw)
~~~~
En la sección ***Volumes*** ver la información del volumen tipo HostPath:
~~~~
Volumes:
  static-vol:
    Type:          HostPath (bare host directory volume)
    Path:          /home/kubelab/kubelabs/kubelabs-files-demo/14
~~~~

## Listar el NodePort del pod y probar.
```vim
kubectl describe service pod-storage-svc | grep NodePort

# probar en browser:
<ip-public>:<nodePort>
```

## 3. Opcional, cambiar el contenido del archivo html
Conectar por SSH al servidor y cambiar el contenido del archivo html.

Cambiar la línea 21 del archivo: [kubelabs-files-demo/14/index.html](./kubelabs-files-demo/14/index.html)

## Agregar un volumen persistente en Cloud
Para almacenar las salidas de los logs Nginx (/var/nginx/logs), agregar un volumen persistente al pod:

